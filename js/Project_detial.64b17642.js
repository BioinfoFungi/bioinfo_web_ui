(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Project_detial"],{"0db5":function(t,a,e){"use strict";var n=e("9efd"),o="/api/project",r={page:function(t){return Object(n["a"])({url:"".concat(o),params:t,method:"get"})},add:function(t){return Object(n["a"])({url:o,data:t,method:"post"})},updateContent:function(t,a){return Object(n["a"])({url:"".concat(o,"/updateContent/").concat(t),data:a,method:"post"})},update:function(t,a){return Object(n["a"])({url:"".concat(o,"/update/").concat(t),data:a,method:"post"})},findById:function(t){return Object(n["a"])({url:"".concat(o,"/find/").concat(t),method:"get"})},del:function(t){return Object(n["a"])({url:"".concat(o,"/del/").concat(t),method:"get"})}};a["a"]=r},"1d6b":function(t,a,e){"use strict";e.r(a);var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("a-row",{attrs:{type:"flex",justify:"end"}},[e("a-col",{attrs:{span:4}},[e("a-button",{on:{click:t.refresh}},[t._v("刷新")])],1)],1),e("a-divider"),e("a-descriptions",{attrs:{title:t.data.name,bordered:""}},[e("a-descriptions-item",{attrs:{label:"项目创建人",span:1}},[t._v(t._s(t.data.user?t.data.user.username:""))]),e("a-descriptions-item",{attrs:{label:"项目责任人",span:2}},t._l(t.data.chargePerson,(function(a){return e("span",{key:a.id},[t._v(" "+t._s(a.username)+" "),e("a-divider",{attrs:{type:"vertical"}})],1)})),0),e("a-descriptions-item",{attrs:{label:"创建时间"}},[t._v(t._s(t.moment(t.data.createDate,"YYYY-MM-DD HH:mm:ss").fromNow()))]),e("a-descriptions-item",{attrs:{label:"更新时间"}},[t._v(t._s(t.moment(t.data.updateDate,"YYYY-MM-DD HH:mm:ss").fromNow()))]),e("a-descriptions-item",{attrs:{label:"截止时间"}},[t._v(t._s(t.moment(t.data.deadline,"YYYY-MM-DD HH:mm:ss").fromNow()))]),e("a-descriptions-item",{attrs:{label:"完成状态",span:3}},[e("a-badge",{attrs:{status:"processing",text:t.data.projectStatus}})],1),e("a-descriptions-item",{attrs:{label:"jupyter结果报告",span:3}},[e("a",{attrs:{href:t.data.jupyterUrl,target:"_blank"}},[t._v(t._s(t.data.jupyterUrl))])]),e("a-descriptions-item",{attrs:{label:"项目描述",span:3}},[t._v(t._s(t.data.description))]),e("a-descriptions-item",{attrs:{label:"项目内容",span:3}},[e("a-row",{attrs:{type:"flex",justify:"end"}},[e("a-col",{attrs:{span:4}},[e("a-button",{on:{click:function(a){return t.content(t.data.id)}}},[t._v("编辑")])],1)],1),e("p",{domProps:{innerHTML:t._s(t.data.formatContent)}})],1),e("a-descriptions-item",{attrs:{label:"附件",span:3}},[e("a-row",{attrs:{type:"flex",justify:"end"}},[e("a-col",{attrs:{span:4}},[e("a-upload",{attrs:{customRequest:t.handleFileChange}},[e("a-button",[e("a-icon",{attrs:{type:"upload"}}),t._v("上传附件 ")],1)],1)],1)],1),t._l(t.attachments,(function(a){return e("a-tag",{key:a.id},[e("a",{attrs:{target:"_blank",href:t.attachmentPath(a.path)}},[t._v(t._s(a.fileName))]),e("a-icon",{attrs:{type:"close"},on:{click:function(e){return t.delAttachment(a.id)}}})],1)}))],2)],1),e("a-comment",[e("a-avatar",{attrs:{slot:"avatar",src:"https://zos.alipayobjects.com/rmsportal/ODTLcjxAfvqbxHnVXCYX.png",alt:"Han Solo"},slot:"avatar"}),e("div",{attrs:{slot:"content"},slot:"content"},[e("a-form-item",{attrs:{prop:"content_rule"}},[e("a-textarea",{attrs:{rows:4},model:{value:t.comment_value,callback:function(a){t.comment_value=a},expression:"comment_value"}})],1),e("a-form-item",[e("a-button",{attrs:{"html-type":"submit",type:"primary"},on:{click:t.Submit}},[t._v("添加评论")])],1)],1)],1),t._l(t.comments,(function(a){return e("a-comment",{key:a.id},[e("template",{slot:"actions"},[e("span",{key:"comment-basic-reply-to"},[t._v("回复")]),e("span",{key:"comment-basic-reply-to",on:{click:function(e){return t.del(a.id)}}},[t._v("删除")])]),e("a",{attrs:{slot:"author"},slot:"author"},[t._v(t._s(a.user.username))]),e("a-avatar",{attrs:{slot:"avatar",src:a.user.avatar,alt:"Han Solo"},slot:"avatar"}),e("p",{attrs:{slot:"content"},slot:"content"},[t._v(t._s(a.content))]),e("a-tooltip",{attrs:{slot:"datetime"},slot:"datetime"},[e("span",[t._v(t._s(t.moment(a.updateDate,"YYYY-MM-DD HH:mm:ss").fromNow()))])])],2)})),e("div",{staticClass:"page-wrapper",style:{textAlign:"right"}},[e("a-pagination",{staticClass:"pagination",attrs:{current:t.pagination.page,total:t.pagination.total,defaultPageSize:t.pagination.size,pageSizeOptions:["5","10","20","50","100"],showSizeChanger:""},on:{showSizeChange:t.handleTableChange,change:t.handleTableChange}})],1)],2)},o=[],r=e("0db5"),s=e("9efd"),c="/api/comment",i={pageByPId:function(t,a){return Object(s["a"])({url:"".concat(c,"/projectId/").concat(t),params:a,method:"get"})},add:function(t){return Object(s["a"])({url:c,data:t,method:"post"})},del:function(t){return Object(s["a"])({url:"".concat(c,"/del/").concat(t),method:"get"})}},l=i,u=e("a796"),d=e("c1df"),m=e.n(d),p={data:function(){return{projectId:null,comment_value:"",data:{},comments:[],moment:m.a,attachments:[],pagination:{page:1,size:10,sort:null},queryParam:{page:0,size:10,sort:null,keyword:null,categoryId:null,status:null},rules:{content_rule:[{required:!0,message:"Please select Activity zone",trigger:"change"}]},Attachment_base_url:""}},computed:{},beforeRouteEnter:function(t,a,e){var n=t.query.projectId;e((function(t){n&&(t.projectId=n,t.loadProject(n))}))},mounted:function(){this.loadComment(),this.loadAttachment();var t=JSON.parse(localStorage.getItem("global_config"));this.Attachment_base_url=t.Attachment_base_url},methods:{loadAttachment:function(){var t=this,a=this.$route.query.projectId;u["a"].listByPId(a).then((function(a){t.attachments=a.data.data}))},handleTableChange:function(t,a){this.pagination.page=t,this.pagination.size=a,this.loadComment()},loadProject:function(t){var a=this;r["a"].findById(t).then((function(t){var e=t.data.data;a.data=e}))},loadComment:function(){var t=this;this.queryParam.page=this.pagination.page-1,this.queryParam.size=this.pagination.size,this.queryParam.sort=this.pagination.sort;var a=this.$route.query.projectId;l.pageByPId(a,this.queryParam).then((function(a){t.comments=a.data.data.content,t.pagination.total=parseInt(a.data.data.totalElements)}))},Submit:function(){var t=this,a=this.$route.query.projectId;l.add({projectId:a,content:this.comment_value}).then((function(a){t.$notification["success"]({message:"评论添加成功!"+a.data.message}),t.loadComment(),t.comment_value=""}))},del:function(t){var a=this;l.del(t).then((function(t){a.$notification["success"]({message:"评论删除成功!"+t.data.message}),a.loadComment()}))},delAttachment:function(t){var a=this.loadAttachment,e=this.$notification["success"];this.$confirm({title:"删除附件",content:"您确定要删除该附件吗",onOk:function(){u["a"].del(t).then((function(t){a(),e({message:"附件删除成功!"+t.data.message})}))},onCancel:function(){}})},content:function(t){this.$router.push({name:"Project_content",query:{projectId:t}})},refresh:function(){this.loadProject(this.data.id),this.loadComment(),this.loadAttachment()},attachmentPath:function(t){return"http"==t.substring(0,4)?t:this.Attachment_base_url+"/"+t},handleFileChange:function(t){var a=this;this.formData=new FormData,this.formData.append("file",t.file),this.formData.append("projectId",this.data.id),u["a"].upload(this.formData).then((function(n){t.onSuccess(n,t.file),a.loadAttachment(),e.percent=99}));var e={percent:1},n=100/(t.file.size/65e3),o=setInterval((function(){e.percent<100?(e.percent+=n,t.onProgress(e)):clearInterval(o)}),100)}}},h=p,f=e("2877"),g=Object(f["a"])(h,n,o,!1,null,null,null);a["default"]=g.exports},"75f4":function(t,a,e){"use strict";e.r(a);var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("a-textarea",{attrs:{placeholder:"Basic usage",rows:20},model:{value:t.data.originalContent,callback:function(a){t.$set(t.data,"originalContent",a)},expression:"data.originalContent"}}),e("a-button",{on:{click:t.submit}},[t._v("提交")])],1)},o=[],r=e("0db5"),s={data:function(){return{data:{}}},created:function(){},beforeRouteEnter:function(t,a,e){var n=t.query.projectId;e((function(t){n&&(t.projectId=n,r["a"].findById(n).then((function(a){var e=a.data.data;t.data=e})))}))},methods:{submit:function(){var t=this;r["a"].updateContent(this.data.id,{content:this.data.originalContent}).then((function(a){t.$notification["success"]({message:"项目内容更新!"+a.data.message}),t.$router.push("/project/detial?projectId="+t.data.id)}))}}},c=s,i=e("2877"),l=Object(i["a"])(c,n,o,!1,null,null,null);a["default"]=l.exports},a796:function(t,a,e){"use strict";var n=e("9efd"),o="/api/attachment",r={page:function(t){return Object(n["a"])({url:"".concat(o),params:t,method:"get"})},pageByPId:function(t,a){return Object(n["a"])({url:"".concat(o,"/page/").concat(t),params:a,method:"get"})},listByPId:function(t){return Object(n["a"])({url:"".concat(o,"/list/").concat(t),method:"get"})},add:function(t){return Object(n["a"])({url:o,data:t,method:"post"})},upload:function(t){return Object(n["a"])({url:"".concat(o,"/upload"),data:t,method:"post"})},uploadFiles:function(t,a){return Object(n["a"])({url:"".concat(o,"/uploadFiles/").concat(t),data:a,method:"post"})},del:function(t){return Object(n["a"])({url:"".concat(o,"/del/").concat(t),method:"get"})}};a["a"]=r}}]);
//# sourceMappingURL=Project_detial.64b17642.js.map